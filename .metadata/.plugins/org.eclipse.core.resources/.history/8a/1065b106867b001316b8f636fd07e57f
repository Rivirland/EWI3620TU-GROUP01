package playerStates;
import java.sql.SQLException;

import javax.media.opengl.GL;
import javax.media.opengl.GLAutoDrawable;

import engine.InputDialog;
import engine.MazeRunner;
import menu.Main;
import menu.Teken;

public class PlayerStateVictory extends PlayerState{

	@Override
	public void itemUse() {
//		MazeRunner.player.reset();
////		MazeRunner.player.score = 1000;
//		for(int e = 0; e < MazeRunner.enemyList.size(); e++){
//			MazeRunner.enemyList.get(e).reset();
//		}
//		Player.canTeleport = false;
//		Player.playerStateInt = 0;
//		Player.canMove = true;
	}

	@Override
	public void entering() {
		MazeRunner.player.getControl().info = true;
		MazeRunner.player.getControl().minimap = false;
		MazeRunner.player.canMove = false;
		InputDialog ID = new InputDialog();
		String name = ID.getName();
//		System.out.println("Victory! Score: " + MazeRunner.player.score);	
		try {
//			Main.db.stat.executeUpdate("DROP TABLE IF EXISTS highscores" + MazeRunner.level.getNaam());
			// stat.executeUpdate("CREATE TABLE students (studentnumber INT, name STRING);");
			Main.db.stat.executeUpdate("CREATE TABLE IF NOT EXISTS highscores" + MazeRunner.level.getNaam()
					+ " (naam STRING, score INT, time INT);");
			Main.db.stat.executeUpdate("INSERT INTO highscores" + MazeRunner.level.getNaam()
					+ " (naam, score, time) values ('" + name + "', " + MazeRunner.player.score + ", " + MazeRunner.playingTime + ");");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
//		Main.db.printHighscores("SELECT * FROM highscores" + MazeRunner.level.getNaam() + " ORDER BY score DESC LIMIT 0,4");
	}

	@Override
	public void leaving() {
		//nothing
		
	}

	@Override
	public void drawInfo(GLAutoDrawable autodrawable, GL gl){
		String st= "SELECT * FROM highscores" + MazeRunner.level.getNaam() + " ORDER BY score, time DESC LIMIT 0,5";
		Main.db.printHighscores(autodrawable, gl, st);
	}

	@Override
	public void displayItem(GL gl) {
		// nothing		
	}

}
